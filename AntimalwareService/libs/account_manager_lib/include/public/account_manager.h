#pragma once

#include <curl/curl.h>
#include <iostream>
#include <format>
#include <regex>
#include <Logger.h>

namespace AccountManager
{
    class HTTPManager
    {
        private:
            std::string baseUrl = "https://localhost";

            std::string jwtToken = "";
            std::string refreshToken = "";
            int deviceId = NULL;

        public:
            HTTPManager();
            
            std::string GetAccessToken()
            {
                return this->jwtToken;
            }

            std::string GetRefreshToken()
            {
                return this->refreshToken;
            }

            bool sendHttpRequest(
                const std::string& url, const std::string& jsonData, std::string& response);

            void LogResponse(std::string response);

            std::string Register(
                std::string username,
                std::string email,
                std::string password
            );

            std::string Login(
                std::string email,
                std::string password,
                int deviceId
            );

            VOID RefreshToken();

            VOID LogOut();
    };
}