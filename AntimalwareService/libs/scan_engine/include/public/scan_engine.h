#pragma once
#include <memory>
#include "../../../av_bases_lib/include/public/AvBases.h"
#include "../../../os_services_lib/include/public/IOStream.h"
#include "../../../os_services_lib/include/public/file_stream.h"

class ScanEngine
{
public:
	ScanEngine(const std::shared_ptr<AvBases>& bases);
	bool ScanFile(const std::shared_ptr<IOStream> stream, std::string& malwareName);
	std::vector<uint8_t> GetHash(const uint8_t* data, const size_t data_size);
	std::string ToHexString(const std::vector<uint8_t>& data);
	void SetBases(const std::shared_ptr<AvBases>& newBases);
private:
	std::shared_ptr<AvBases> bases;
};